class CMDBox{constructor(t={}){this.options=Object.assign({width:500,height:300,minWidth:200,minHeight:100,initialText:"C:\\> Welcome to CMD-like box\nC:\\>_",backgroundColor:"#1e1e1e",textColor:"#00ff00",fontFamily:"monospace",fontSize:"14px"},t),this.createStyles(),this.createBox(),this.attachEvents()}createStyles(){if(document.getElementById("cmd-box-style"))return;const t=document.createElement("style");t.id="cmd-box-style",t.innerHTML=`@keyframes fadeIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@keyframes fadeOut{from{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.95)}}.cmd-box.show{animation:fadeIn .3s ease-out forwards}.cmd-box.hide{animation:fadeOut .3s ease-in forwards}.cmd-box{position:fixed;top:100px;left:100px;width:${this.options.width}px;height:${this.options.height}px;background-color:${this.options.backgroundColor};color:${this.options.textColor};font-family:${this.options.fontFamily};font-size:${this.options.fontSize};border:2px solid #333;border-radius:5px;padding:10px;overflow-y:auto;box-sizing:border-box;white-space:pre-wrap;display:none}.resize-handle{position:absolute;width:15px;height:15px;right:0;bottom:0;cursor:se-resize;background-color:#555;border-top-left-radius:4px;z-index:10000}`,document.head.appendChild(t)}createBox(){this.box=document.createElement("div"),this.box.className="cmd-box",this.box.setAttribute("contenteditable","true"),this.box.innerText=this.options.initialText,document.body.appendChild(this.box),this.resizeHandle=document.createElement("div"),this.resizeHandle.className="resize-handle",this.box.appendChild(this.resizeHandle)}attachEvents(){let t=!1,e=0,i=0;this.box.addEventListener("mousedown",(s=>{s.target!==this.resizeHandle&&!window.getSelection().toString()&&(t=!0,e=s.clientX-this.box.offsetLeft,i=s.clientY-this.box.offsetTop,this.box.style.userSelect="none")}));let s=!1;this.resizeHandle.addEventListener("mousedown",(t=>{t.stopPropagation(),s=!0})),document.addEventListener("mousemove",(t=>{if(t)t.preventDefault(),t.stopPropagation();t&&(t.preventDefault(),t.stopPropagation());if(t){if(t.preventDefault(),t.stopPropagation(),t)return;return;if(t.preventDefault(),t.stopPropagation(),t)return;return;t.preventDefault(),t.stopPropagation()}t?t.preventDefault():null,t.preventDefault();if(t)if(t.preventDefault(),t.stopPropagation(),t)return;if(t.preventDefault(),t.stopPropagation(),t)return;t.preventDefault(),t.stopPropagation()})),document.addEventListener("mousemove",(e=>{if(t)this.box.style.left=`${e.clientX-e}px`,this.box.style.top=`${e.clientY-i}px`;else if(s){const t=e.clientX-this.box.offsetLeft,i=e.clientY-this.box.offsetTop;this.box.style.width=`${Math.max(this.options.minWidth,t)}px`,this.box.style.height=`${Math.max(this.options.minHeight,i)}px`}})),document.addEventListener("mouseup",(()=>{t=!1,s=!1,this.box.style.userSelect=""})),this.box.addEventListener("keydown",(t=>{if("Enter"===t.key){t.preventDefault();const e=this.box.innerText.trim().split("\n").pop().replace(/^.*> ?/,"").trim();"function"==typeof this.onEnter&&this.onEnter(e),this.appendLine("C:\\>_")}}))}onEnter(t){console.log("User typed:",t)}show(){this.box.style.display="block",this.box.classList.remove("hide"),void this.box.offsetWidth,this.box.classList.add("show")}hide(){this.box.classList.remove("show"),this.box.classList.add("hide"),this.box.addEventListener("animationend",(()=>{this.box.classList.contains("hide")&&(this.box.style.display="none")}),{once:!0})}toggle(){"none"===this.box.style.display?this.show():this.hide()}setText(t){this.box.innerText=t}appendLine(t){this.box.innerText+=`\n${t}`,this.box.scrollTop=this.box.scrollHeight}}
